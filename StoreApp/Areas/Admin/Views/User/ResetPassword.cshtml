@model ResetPasswordDto

<link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />

<div class="text-center my-5">
    <div class="display-6 border-bottom pb-2">Şifre Sıfırla (@Model?.UserName)</div>
</div>

<div class="container" style="max-width: 820px;">
    <div class="card form-card shadow-soft">
        <div class="card-body p-4">

            <div class="text-danger mb-2" asp-validation-summary="All"></div>

            <form method="post" asp-action="ResetPassword" class="row g-3">
                <input type="hidden" asp-for="UserName" />

                <div class="col-12">
                    <label asp-for="Password" class="form-label">Yeni Şifre</label>
                    <div class="pwd-wrap">
                        <input asp-for="Password" class="form-control form-control-soft pwd-input" type="password"
                            autocomplete="new-password" />
                        <span id="togglePwd1" class="pwd-toggle-link" role="button" tabindex="0"
                            aria-pressed="false">Göster</span>
                    </div>
                    <span asp-validation-for="Password" class="text-danger small"></span>
                </div>

                <div class="col-12">
                    <label asp-for="ConfirmPassword" class="form-label">Tekrar Yeni Şifre</label>
                    <div class="pwd-wrap">
                        <input asp-for="ConfirmPassword" class="form-control form-control-soft pwd-input"
                            type="password" autocomplete="new-password" />
                        <span id="togglePwd2" class="pwd-toggle-link" role="button" tabindex="0"
                            aria-pressed="false">Göster</span>
                    </div>
                    <span asp-validation-for="ConfirmPassword" class="text-danger small"></span>
                </div>

                <div class="col-12 d-flex justify-content-end gap-2 mt-3">
                    <a asp-action="Index" class="btn btn-outline-navy btn-pill">
                        <i class="fa fa-solid fa-users"></i> Kullanıcılar
                    </a>
                    <button type="submit" class="btn btn-navy btn-pill">
                        <i class="fa fa-solid fa-key"></i> Güncelle
                    </button>
                </div>
            </form>

        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Input içinde Göster/Gizle (buton değil, metin-link)
        document.addEventListener('DOMContentLoaded', function () {
            function wireToggle(linkId, inputId) {
                const link = document.getElementById(linkId);
                const input = document.getElementById(inputId);
                if (!link || !input) return;

                function toggle() {
                    const isHidden = input.type === 'password';
                    input.type = isHidden ? 'text' : 'password';
                    link.textContent = isHidden ? 'Gizle' : 'Göster';
                    link.setAttribute('aria-pressed', String(isHidden));
                }

                link.addEventListener('click', toggle);
                link.addEventListener('keydown', function (e) {
                    if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggle(); }
                });
            }

            // Razor tarafından üretilen input id'lerini kullan
            wireToggle('togglePwd1', '@Html.IdFor(m => m.Password)');
            wireToggle('togglePwd2', '@Html.IdFor(m => m.ConfirmPassword)');
        });
    </script>
}