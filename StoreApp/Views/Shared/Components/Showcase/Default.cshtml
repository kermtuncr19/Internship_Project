@using StoreApp.Models
@model ShowcaseViewModel
<link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />

<!-- üî• Vƒ∞TRƒ∞N √úR√úNLERƒ∞ -->
@if (Model.ShowcaseProducts != null && Model.ShowcaseProducts.Any())
{
    <div class="container py-5">
        <div class="showcase-header mb-4">
            <h2 class="showcase-title">
                <i class="fa-solid fa-star"></i>
                Vitrin √úr√ºnleri
            </h2>
            <a asp-controller="Product" asp-action="Index" class="showcase-view-all">
                T√ºm√ºn√º G√∂r <i class="fa-solid fa-arrow-right ms-1"></i>
            </a>
        </div>

        <div class="related-products-wrapper">
            <button class="carousel-btn carousel-btn-prev" id="showcaseScrollLeft">
                <i class="fa fa-chevron-left"></i>
            </button>

            <div class="related-products-container" id="showcaseContainer">
                @foreach (var product in Model.ShowcaseProducts)
                {
                    <div class="related-product-card">
                        <partial name="_ProductCard"
                                 model="product"
                                 view-data='new ViewDataDictionary(ViewData) { ["WrapperClass"] = "" }' />
                    </div>
                }
            </div>

            <button class="carousel-btn carousel-btn-next" id="showcaseScrollRight">
                <i class="fa fa-chevron-right"></i>
            </button>
        </div>
    </div>
}

<!-- ‚≠ê EN √áOK FAVORƒ∞LENENLER -->
@if (Model.MostFavorited != null && Model.MostFavorited.Any())
{
    <div class="container py-5">
        <div class="showcase-header mb-4">
            <h2 class="showcase-title">
                <i class="fa-solid fa-heart"></i>
                En √áok Favorilenenler
            </h2>
            <a asp-controller="Product" asp-action="Index" class="showcase-view-all">
                T√ºm√ºn√º G√∂r <i class="fa-solid fa-arrow-right ms-1"></i>
            </a>
        </div>

        <div class="related-products-wrapper">
            <button class="carousel-btn carousel-btn-prev" id="favoritedScrollLeft">
                <i class="fa fa-chevron-left"></i>
            </button>

            <div class="related-products-container" id="favoritedContainer">
                @foreach (var product in Model.MostFavorited)
                {
                    <div class="related-product-card">
                        <partial name="_ProductCard"
                                 model="product"
                                 view-data='new ViewDataDictionary(ViewData) { ["WrapperClass"] = "" }' />
                    </div>
                }
            </div>

            <button class="carousel-btn carousel-btn-next" id="favoritedScrollRight">
                <i class="fa fa-chevron-right"></i>
            </button>
        </div>
    </div>
}

<!-- üÜï YENƒ∞ EKLENENLER -->
@if (Model.NewArrivals != null && Model.NewArrivals.Any())
{
    <div class="container py-5">
        <div class="showcase-header mb-4">
            <h2 class="showcase-title">
                <i class="fa-solid fa-wand-magic-sparkles"></i>
                Yeni Eklenenler
            </h2>
            <a asp-controller="Product" asp-action="Index" class="showcase-view-all">
                T√ºm√ºn√º G√∂r <i class="fa-solid fa-arrow-right ms-1"></i>
            </a>
        </div>

        <div class="related-products-wrapper">
            <button class="carousel-btn carousel-btn-prev" id="newScrollLeft">
                <i class="fa fa-chevron-left"></i>
            </button>

            <div class="related-products-container" id="newContainer">
                @foreach (var product in Model.NewArrivals)
                {
                    <div class="related-product-card">
                        <partial name="_ProductCard"
                                 model="product"
                                 view-data='new ViewDataDictionary(ViewData) { ["WrapperClass"] = "" }' />
                    </div>
                }
            </div>

            <button class="carousel-btn carousel-btn-next" id="newScrollRight">
                <i class="fa fa-chevron-right"></i>
            </button>
        </div>
    </div>
}

<!-- üî• √áOK SATANLAR -->
@if (Model.BestSellers != null && Model.BestSellers.Any())
{
    <div class="container py-5">
        <div class="showcase-header mb-4">
            <h2 class="showcase-title">
                <i class="fa-solid fa-fire"></i>
                √áok Satanlar
            </h2>
            <a asp-controller="Product" asp-action="Index" class="showcase-view-all">
                T√ºm√ºn√º G√∂r <i class="fa-solid fa-arrow-right ms-1"></i>
            </a>
        </div>

        <div class="related-products-wrapper">
            <button class="carousel-btn carousel-btn-prev" id="bestsellersScrollLeft">
                <i class="fa fa-chevron-left"></i>
            </button>

            <div class="related-products-container" id="bestsellersContainer">
                @foreach (var product in Model.BestSellers)
                {
                    <div class="related-product-card">
                        <partial name="_ProductCard"
                                 model="product"
                                 view-data='new ViewDataDictionary(ViewData) { ["WrapperClass"] = "" }' />
                    </div>
                }
            </div>

            <button class="carousel-btn carousel-btn-next" id="bestsellersScrollRight">
                <i class="fa fa-chevron-right"></i>
            </button>
        </div>
    </div>
}

<script>
document.addEventListener('DOMContentLoaded', function () {
    // T√ºm carousel'larƒ± tanƒ±mla
    const carousels = [
        { container: 'showcaseContainer', left: 'showcaseScrollLeft', right: 'showcaseScrollRight' },
        { container: 'favoritedContainer', left: 'favoritedScrollLeft', right: 'favoritedScrollRight' },
        { container: 'newContainer', left: 'newScrollLeft', right: 'newScrollRight' },
        { container: 'bestsellersContainer', left: 'bestsellersScrollLeft', right: 'bestsellersScrollRight' }
    ];

    carousels.forEach(carousel => {
        const container = document.getElementById(carousel.container);
        const btnLeft = document.getElementById(carousel.left);
        const btnRight = document.getElementById(carousel.right);

        if (!container || !btnLeft || !btnRight) return;

        const scrollAmount = 270;
        let isScrolling = false;

        function scroll(direction) {
            if (isScrolling) return;
            isScrolling = true;

            const scrollLeft = container.scrollLeft;
            const maxScroll = container.scrollWidth - container.clientWidth;

            if (direction === 'right') {
                if (scrollLeft >= maxScroll - 10) {
                    container.scrollTo({ left: 0, behavior: 'smooth' });
                } else {
                    container.scrollBy({ left: scrollAmount, behavior: 'smooth' });
                }
            } else {
                if (scrollLeft <= 10) {
                    container.scrollTo({ left: maxScroll, behavior: 'smooth' });
                } else {
                    container.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
                }
            }

            setTimeout(() => { isScrolling = false; }, 500);
        }

        btnRight.addEventListener('click', () => scroll('right'));
        btnLeft.addEventListener('click', () => scroll('left'));

        // Otomatik kaydƒ±rma
        let autoScrollInterval = setInterval(() => scroll('right'), 5000);

        container.addEventListener('mouseenter', () => clearInterval(autoScrollInterval));
        container.addEventListener('mouseleave', () => {
            autoScrollInterval = setInterval(() => scroll('right'), 5000);
        });
    });
});
</script>
